@page
@model MinaGroup.Backend.Pages.Management.ServiceManagement.IndexModel
@{
    ViewData["Title"] = "Serviceintegrationer";
}

<div class="container mt-5">
    <h1 class="text-center display-4 mb-2 fw-bold text-primary">
        Serviceintegrationer
    </h1>
    <p class="text-center fs-5 text-muted mb-4">
        Administrer tilknytning til eksterne tjenester for virksomheden.
    </p>

    <hr />

    @* Hvis der mod forventning ikke er en organisation, viser vi en kort besked *@
    @if (Model.CurrentOrganization == null)
    {
        <div class="alert alert-warning">
            Der er ikke tilknyttet nogen virksomhed til din bruger.
        </div>

        <div class="mt-3">
            <a asp-page="/Management/Index" class="btn btn-outline-secondary">
                Tilbage til administrationspanel
            </a>
        </div>
    }
    else
    {
        <div class="mb-3">
            <span class="text-muted">
                Aktiv organisation:
            </span>
            <strong>@Model.CurrentOrganization.Name</strong>
            @if (!string.IsNullOrWhiteSpace(Model.CurrentOrganization.OrganizationAdress))
            {
                <span class="text-muted">
                    – @Model.CurrentOrganization.OrganizationAdress,
                    @Model.CurrentOrganization.PostalCode @Model.CurrentOrganization.Town
                </span>
            }
        </div>

        <div class="row g-4">
            @* --- Google Drive card --- *@
            <div class="col-md-6">
                <div class="card shadow-sm border-0 h-100">
                    <div class="card-body d-flex flex-column">
                        <h5 class="card-title text-primary fw-bold">
                            Google Drive
                        </h5>

                        <p class="card-text text-muted mb-3">
                            Opsæt upload af PDF-rapporter og andre dokumenter fra systemet
                            til virksomhedens Google Drive-konto.
                        </p>

                        <p class="mb-3">
                            @if (Model.GoogleDriveHasRefreshToken)
                            {
                                <span class="badge bg-success">Forbundet</span>

                                @if (!string.IsNullOrWhiteSpace(Model.GoogleDriveConnectedAccountEmail))
                                {
                                    <span class="ms-2">
                                        (@Model.GoogleDriveConnectedAccountEmail)
                                    </span>
                                }

                                @if (!Model.GoogleDriveIsEnabled)
                                {
                                    <span class="ms-2 text-warning">
                                        (Deaktiveret – upload er slået fra)
                                    </span>
                                }
                            }
                            else
                            {
                                <span class="badge bg-secondary">Ikke forbundet</span>
                                <span class="ms-2 text-muted">
                                    Klik på "Administrer" for at forbinde til Google Drive.
                                </span>
                            }
                        </p>

                        <div class="mt-auto d-flex justify-content-end">
                            <a asp-page="./GoogleDriveService"
                               class="btn btn-outline-primary fw-bold">
                                Administrer Google Drive
                            </a>
                        </div>
                    </div>
                </div>
            </div>

            @* 
               Fremtidige services:
               - OneDrive
               - Dropbox
               - Andre integrationer

               Du kan kopiere ovenstående card, justere tekst og linke til nye sider
               når du implementerer dem.
            *@
        </div>

        <div class="mt-4">
            <a asp-page="/Management/Index" class="btn btn-outline-secondary">
                Tilbage til administrationspanel
            </a>
        </div>
    }
</div>

@section Scripts {
    <partial name="_ValidationScriptsPartial" />
}